<div class="container-fluid">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 text-center">
            <form novalidate class="form-inline lead" role="form">
                <div class="form-group">
                    <select ng-model="artifact.type" class="input input-lg" name="search-type" id="search-type">
                        <option value>- select type -</option>
                        <option value="ipv4"> ipv4 </option>
                        <!--<option value="ipv4-range"> ipv4 range </option>-->
                        <!--<option value="ipv6"> ipv6 </option>-->
                        <!--<option value="ipv6-range"> ipv6 range </option>-->
                        <!--<option value="email"> email address </option>-->
                        <option value="fqdn"> fqdn </option>
                        <!--<option value="asn"> asn </option>-->
                        <!--<option value="md5"> md5 </option>-->
                        <!--<option value="sha256"> sha256 </option>-->
                    </select>
                    <input ng-model="artifact.term" class="input input-lg form-control" type="text" name="search-term" id="search-term" placeholder="artifact...">
                    <button class="btn btn-default btn-lg" ng-click="m.formSearch(artifact)"><span class="glyphicon glyphicon-search"></span></button>
                </div>
            </form>
        </div>
    </div>

    <div class="row placeholders">
        <div class="col-xs-6 col-sm-4 placeholder">
            <h4>First Seen</h4>
            <h1 class="lead text-info"><strong>{{m.query.facets.min_import_time | date: 'MMMM dd, yyyy HH:mm:ss'}}</strong></h1>
            <span class="text-muted">Detect Min {{m.query.facets.min_detect_time | date: 'Z'}}</span>
        </div>
        <div class="col-xs-6 col-sm-4 placeholder">
            <h4>Last Seen</h4>
            <h1 class="lead text-info"><strong>{{m.query.facets.max_import_time | date: 'MMMM dd, yyyy HH:mm:ss'}}</strong></h1>
            <span class="text-muted">Detect Max {{m.query.facets.max_detect_time | date: 'Z'}}</span>
        </div>
        <div class="col-xs-6 col-sm-4 placeholder">
            <h4>Feed Hits</h4>
            <h1 class="lead text-info"><strong>{{m.query.facets.feed_names.length}}</strong></h1>
            <span class="text-muted"># of feed names</span>
        </div>

        <!--
        <div class="col-xs-6 col-sm-3 placeholder">
            <h4>Search Count</h4>
            <h1 class="lead text-info"><strong>41</strong></h1>
            <span class="text-muted">number of times searched</span>
        </div>
        -->
    </div>

    <!--
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-6">
            <button type="button" class="btn btn-default" disabled="disabled"><span class="glyphicon glyphicon-filter"></span>source</button>
            <button type="button" class="btn btn-default" ng-click="m.collapsedDetect = !m.collapsedDetect"><span class="glyphicon glyphicon-filter"></span>detect time</button>
            <button type="button" class="btn btn-default" ng-click="m.collapsedImport = !m.collapsedImport"><span class="glyphicon glyphicon-filter"></span>import time</button>
        </div>
    </div>
    -->

    <div class="row badges">
        <div class="col-xs-12 col-sm-12 col-md-12 text-center">
            <a href="#"><span class="badge alert-default">All Events ({{m.query.total_events}})</span></a>
                    <span ng-repeat="source in m.query.facets.sources">
                        <a href="#"><span class="badge alert-info">{{source[0]}} ({{source[1]}})</span></a>
                    </span>
                    <span ng-repeat="provider in m.query.facets.feed_providers">
                        <a href="#"><span class="badge alert-warning">{{provider[0]}} ({{provider[1]}})</span></a>
                    </span>
                    <span ng-repeat="name in m.query.facets.feed_names">
                        <a href="#"><span class="badge alert-danger">{{name[0]}} ({{name[1]}})</span></a>
                    </span>
            <br />
            <br />
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-6">
            <small class="text-info"><strong>Order by: </strong></small><small class="text-info">{{m.getOrderBy()}}</small>
            <small class="text-info"><strong>Order: </strong></small><small class="text-info">{{m.getOrder()}}</small>
            <small class="text-info"><strong>Type: </strong></small><small class="text-info">{{m.getType()}}</small>
            <small class="text-info"><strong>Term: </strong></small><small class="text-info">{{m.getTerm()}}</small>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-6">
            <small ng-if="m.getImportMin()" class="text-info"><strong>Import Min: </strong></small>
            <small ng-if="m.getImportMin()" class="text-danger">{{m.getImportMin() | date: 'MM-dd-yyyy HH:mm:ss Z'}}</small>
            <button ng-if="m.getImportMin()" ng-click="m.removeImportMin()" class="btn btn-xs btn-link"><span class="glyphicon glyphicon-remove text-danger"></span></button>

            <small ng-if="m.getImportMax()" class="text-info"><strong>Import Max: </strong></small>
            <small ng-if="m.getImportMax()" class="text-danger">{{m.getImportMax() | date: 'MM-dd-yyyy HH:mm:ss Z'}}</small>
            <button ng-if="m.getImportMax()" ng-click="m.removeImportMax()" class="btn btn-xs btn-link"><span class="glyphicon glyphicon-remove text-danger"></span></button>

            <small ng-if="m.getDetectMin()" class="text-info"><strong>Detect Min: </strong></small>
            <small ng-if="m.getDetectMin()" class="text-danger">{{m.getDetectMin() | date: 'MM-dd-yyyy HH:mm:ss Z'}}</small>
            <button ng-if="m.getDetectMin()" ng-click="m.removeDetectMin()" class="btn btn-xs btn-link"><span class="glyphicon glyphicon-remove text-danger"></span></button>

            <small ng-if="m.getDetectMax()" class="text-info"><strong>Detect Max: </strong></small>
            <small ng-if="m.getDetectMax()" class="text-danger">{{m.getDetectMax() | date: 'MM-dd-yyyy HH:mm:ss Z'}}</small>
            <button ng-if="m.getDetectMax()" ng-click="m.removeDetectMax()" class="btn btn-xs btn-link"><span class="glyphicon glyphicon-remove text-danger"></span></button>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12">
            <div page-selector></div>

            <table class="table table-condensed table-hover data">
                <thead>
                <tr>
                    <th><strong>Source</strong></th>
                    <th><strong>Provider</strong></th>
                    <th><strong>Feed</strong></th>
                    <th>
                        <strong>Detect Time</strong>
                        <button type="button" class="btn btn-default btn-link" ng-click="m.sortDetect()">
                            <span ng-if="!m.isDetect()" class="glyphicon glyphicon-sort"></span>
                            <span ng-if="m.isDetect()">
                                <span ng-if="m.isAsc()" class="glyphicon glyphicon-chevron-up"></span>
                                <span ng-if="m.isDesc()" class="glyphicon glyphicon-chevron-down"></span>
                            </span>
                        </button>
                    </th>
                    <th>
                        <strong>Import Time</strong>
                        <button type="button" class="btn btn-default btn-link" ng-click="m.sortImport()">
                            <span ng-if="!m.isImport()" class="glyphicon glyphicon-sort"></span>
                            <span ng-if="m.isImport()">
                                <span ng-if="m.isAsc()" class="glyphicon glyphicon-chevron-up"></span>
                                <span ng-if="m.isDesc()" class="glyphicon glyphicon-chevron-down"></span>
                            </span>
                        </button>
                    </th>
                    <th><strong>Tags</strong></th>
                    <th><strong>Details</strong></th>
                </tr>
                </thead>
                <tbody ng-repeat="event in m.query.events">
                <tr>
                    <td><small class="text-danger"><strong><a href='#'>{{event.source}}</a></strong></small></td>
                    <td><small class="text-danger"><strong><a href='#'>{{event.feed_provider}}</a></strong></small></td>
                    <td><small class="text-danger"><strong><a href='#'>{{event.feed_name}}</a></strong></small></td>
                    <td><small>{{event.detect_time}}</small></td>
                    <td><small>{{event.import_time}}</small></td>
                    <td><small ng-repeat="tag in event.tags">{{tag}} </small></td>
                    <td>
                        <button class="btn btn-default btn-link" ng-click="$index = !$index">
                            <span ng-if="$index"><strong><span class="glyphicon glyphicon-plus text-info"></span></strong></span>
                            <span ng-if="!$index"><strong><span class="glyphicon glyphicon-remove text-danger"></span></strong></span>
                        </button>
                    </td>
                </tr>
                <tr ng-hide="$index">
                    <td colspan='7' ng-repeat="domain in event.observables.fqdn">
                        <small><strong>fqdn: </strong></small>
                        <small class="text-danger">
                            <strong>
                                <a ng-href="{{m.getLink('fqdn', domain.fqdn)}}">{{domain.fqdn}}</a>
                            </strong>
                        </small>
                    </td>
                </tr>
                <tr  ng-hide="$index">
                    <td colspan='7' ng-repeat="answer in event.observables.dns_answer">
                        <small><strong>resolver: </strong></small><small>{{answer.resolver}}</small><br />
                        <small><strong>section: </strong></small><small>{{answer.section}}</small><br />
                        <small><strong>name: </strong></small>
                        <small class="text-danger">
                            <strong>
                                <a ng-href="{{m.getLink('fqdn', answer.name)}}">{{answer.name}}</a>
                            </strong>
                        </small><br />
                        <small><strong>rr_class: </strong></small><small>{{answer.rr_class}}</small><br />
                        <small><strong>rr_type: </strong></small><small>{{answer.rr_type}}</small><br />
                        <small><strong>fqdn: </strong></small>
                        <small class="text-danger">
                            <strong>
                                <a ng-href="{{m.getLink('fqdn', answer.fqdn)}}">{{answer.fqdn}}</a>
                            </strong>
                        </small><br />
                        <small><strong>ipv4: </strong></small>
                        <small class="text-danger">
                            <strong>
                                <a ng-href="{{m.getLink('ipv4', answer.ipv4)}}">{{answer.ipv4}}</a>
                            </strong>
                        </small><br />
                        <small><strong>ipv6: </strong></small>
                        <small class="text-danger">
                            <strong>
                                <a ng-href="{{m.getLink('ipv6', answer.ipv6)}}">{{answer.ipv6}}</a>
                            </strong>
                        </small><br />
                    </td>
                </tr>
                </tbody>
            </table>

            <div page-selector></div>
        </div>
    </div>

</div>